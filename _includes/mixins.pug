
-
  var allFiles = [];
  function setAllFiles(files) {
    allFiles = files;
  }
  function slugify(text) {
    return text.toString().toLowerCase()
      .replace(/\s+/g, '-')           // Replace spaces with -
      .replace(/[^\w\-]+/g, '')       // Remove all non-word chars
      .replace(/\-\-+/g, '-')         // Replace multiple - with single -
      .replace(/^-+/, '')             // Trim - from start of text
      .replace(/-+$/, '');            // Trim - from end of text
  }
  function filterFiles(filter_directory) {
    var files = [];
    var len = allFiles.length;
    for (var i = 0; i < len; i++) {
      if (allFiles[i].path.startsWith(filter_directory)) {
        files.push(allFiles[i]);
      }
    }
    return files;
  }

mixin youtube(id)
  div.video-container
    iframe(
      width='853',
      height='480',
      src='https://www.youtube.com/embed/' + id + '?rel=0&amp;showinfo=0',
      frameborder='0',
      allowfullscreen
    )

mixin photos(filter_directory)
  -
    var files = filterFiles(filter_directory);
    var lgClass = files.length > 2 && !(files.length % 4 == 0) ? ' l4' : '';
  div.row
    each file in files
      div(class='col s12 m6' + lgClass)
        img.responsive-img.z-depth-2(src=file.path)

mixin slideShow(filter_directory)
  -
    var number = 0;
    var files = filterFiles(filter_directory);
  div.carousel.carousel-slider.z-depth-2(style='margin-top: 25px; margin-bottom: 25px')
    each file in files
      a.carousel-item(href='#' + slugify(file.path) + '-screenshot-' + number++)
        img(src=file.path)

mixin section(title)
  section.section.wow.fadeIn.scrollspy(id=slugify(title))
    div.header-line
    h2.center-align=title
    block

- var tabContent = {};

mixin addTab(key, active)
  - tabContent[key] = { active: active, link: false, content: this.block };

mixin addLinkTab(key, href, active)
  - tabContent[key] = { active: active, link: true, content: href };

mixin buildTabs()
  div.col.s12
    ul.tabs
      for layout, title in tabContent
        li.tab.col.s3
          if layout.link
            a(class=layout.active ? 'active' : '',
              href=layout.content,
              onclick=layout.active ? '' : 'window.location.replace(\'' + layout.content + '\');'
            )=title
          else
            a(class=layout.active ? 'active' : '',
              href='#' + slugify(title))=title
  for layout, title in tabContent
    div.col.s12(id=slugify(title))
      -
        if (layout.link == false) {
          layout.content();
        }
  - tabContent = {};

mixin game(title)
  p.flow-text.center-align
    span#loadingbar
  div.row(style='margin-top: 25px;')
    canvas.z-depth-2#canvas.emscripten(
      oncontextmenu='event.preventDefault()',
      style='width: 100%; height: 100%;'
    )
    br
    div.fullscreen.right
      img(
        src='TemplateData/fullscreen.png',
        width='38',
        height='38',
        alt='Fullscreen',
        title='Fullscreen',
        onclick='SetFullscreen(1);'
      )
    h5 Controls
    p.flow-text(style='margin-top: 0px')
      block
    script(type='text/javascript').
      window.gameProgress = function(progress, message) {
        if (message) {
          $('#loadingbar').html(message);
        }
      }
      var Module = {
        TOTAL_MEMORY: 268435456,
        errorhandler: null,
        compatibilitycheck: null,
        backgroundColor: "#222C36",
        splashStyle: "Light",
        dataUrl: "Release/webgl-build.data",
        codeUrl: "Release/webgl-build.js",
        asmUrl: "Release/webgl-build.asm.js",
        memUrl: "Release/webgl-build.mem",
      };
    script(src='Release/UnityLoader.js')
